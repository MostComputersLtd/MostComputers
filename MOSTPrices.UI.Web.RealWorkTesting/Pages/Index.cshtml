@page
@using MOSTComputers.UI.Web.RealWorkTesting.Models.Product
@using MOSTComputers.UI.Web.RealWorkTesting.Utils.MappingUtils;
@using MOSTComputers.Models.Product.Models;
@using MOSTComputers.UI.Web.RealWorkTesting.Pages.Shared;
@using MOSTComputers.UI.Web.RealWorkTesting.Pages;

@model IndexModel
@{
    ViewData["Title"] = "Home page";
}

@section Styles {
    <link rel="stylesheet" href="~/css/Pages/Shared/ProductDisplayPopupsCommon.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/Pages/Shared/ProductDisplayImagesPopup.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/Pages/Shared/SearchStringOriginSmallPopupsDisplayPartial.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/Pages/Shared/ProductChangesPopup.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/NotificationBox.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/Pages/Index.css" asp-append-version="true" />
}

@section Scripts {
    <script src="~/js/Index.js"></script>
    <script src="~/js/Pages/Shared/ProductImagesPopupControl.js"></script>
    <script src="~/js/Pages/Shared/ProductFirstImagePopupControl.js"></script>
    <script src="~/js/Pages/Shared/ProductChangesPopupControl.js"></script>
    <script src="~/js/Pages/Shared/SearchStringOriginSmallPopupsDisplayControl.js"></script>
    <script src="~/js/NotificationBox.js"></script>
}

<div>
    <div style="display: flex; flex-direction: row;">

        <input id="_productTableSelectByElementId_input_hidden" type="number" style="display: none;" />
        <input id="_productTableSelectByElementId_tableIndex_input_hidden" type="number" style="display: none;" />
                
        <input id="productTableIdInput" type="number" placeholder="-" />

        <button id="productTableIdInputButton" type="button" onclick="getOnlyProductWithId(
            'productTableIdInput',
            'productTableTbody',
            'productTable_item-@Model.Products.Count.ToString()',
            @Model.Products.Count,
            '_productTableSelectByElementId_input_hidden',
            '_productTableSelectByElementId_tableIndex_input_hidden')">
            Search
        </button>

        <div style="display: flex; flex-direction: column; align-items: center; margin: 0px 1%;">

            <p style="margin-bottom: 0px; font-size: 12px;">Max ID + 1</p>

            <label id="productTableHighestIdLabel" class="link-info" 
                style="font-size: 14px"
                onclick="getOnlyProductWithHighestId(
                    'productTableTbody',
                    'productTable_item-@Model.Products.Count.ToString()',
                    @Model.Products.Count,
                    '_productTableSelectByElementId_input_hidden',
                    'productTable_item-@Model.Products.Count.ToString()__hiddenProductIdInput',
                    '_productTableSelectByElementId_tableIndex_input_hidden')">
                    @(Model.SingleEditedProduct?.Id + 1)
            </label>
        </div>

        <button id="productTableSelectByElementIdButton" type="button" onclick="addNewProductWithExistingProductData(
            '_productTableSelectByElementId_input_hidden',
            'productTableHighestIdLabel',
            'productTableTbody',
            'productTable_item-@Model.Products.Count.ToString()',
            @Model.Products.Count,
            '_productTableSelectByElementId_tableIndex_input_hidden',
            [
                'productTable_item-_NameInput',
                'productTable_item-_AdditionalWarrantyPriceInput',
                'productTable_item-_AdditionalWarrantyTermMonthsInput',
                'productTable_item-_StandardWarrantyPriceInput',
                'productTable_item-_StandardWarrantyTermMonthsInput',
                'productTable_item-_DisplayOrderInput',
                'productTable_item-_StatusSelect',
                'productTable_item-_PlShowInput',
                'productTable_item-_Price1Input',
                'productTable_item-_DisplayPriceInput',
                'productTable_item-_Price3Input',
                'productTable_item-_CurrencySelect',
                'productTable_item-_RowGuidInput',
                'productTable_item-_PromotionIdInput',
                'productTable_item-_PromRidInput',
                'productTable_item-_PromotionPictureIdInput',
                'productTable_item-_PromotionExpireDateInput',
                'productTable_item-_AlertPictureIdInput',
                'productTable_item-_AlertExpireDateInput',
                'productTable_item-_PriceListDescriptionInput',
                'productTable_item-_PartNumber1Input',
                'productTable_item-_PartNumber2Input',
                'productTable_item-_SearchStringInput',
                'productTable_item-_CategorySelect',
                'productTable_item-_ManifacturerSelect',
                'productTable_item-_SubCategoryIdInput',
                'productTable_item-_ProductNewStatusSelect',
                'productTable_item-_ProductXmlStatusSelect',
                'productTable_item-__hiddenProductStatusIdInput',
                'productTable_item-__hiddenReadyForImageInsertInput'])">
            Add product from existing data
        </button>

        <input id="productTableHideFirstRowsCheckboxInput" type="checkbox" onchange="toggleFirstRows(this.checked)"
            style="margin: 0px 7px;" />
    </div>
    
    <table id="productTable" class="table table-responsive hover">
        <thead>
            <tr>
                <th>Product ID</th>
                <th class="hide-on-button-press">Name</th>
                <th class="hide-on-button-press">AddWrr</th>
                <th class="hide-on-button-press">AddWrrTerm</th>
                <th class="hide-on-button-press">AddWrrDef</th>
                <th class="hide-on-button-press">DefWrrTerm</th>
                <th class="hide-on-button-press">S</th>
                <th class="hide-on-button-press">Old</th>
                <th class="hide-on-button-press">PlShow</th>
                <th class="hide-on-button-press">Price1</th>
                <th class="hide-on-button-press">Price2</th>
                <th class="hide-on-button-press">Price3</th>
                <th class="hide-on-button-press">Currency</th>
                <th class="hide-on-button-press">Guid</th>
                <th class="hide-on-button-press">Promotion ID</th>
                <th class="hide-on-button-press">PromRid</th>
                <th class="hide-on-button-press">Promotion Picture ID</th>
                <th class="hide-on-button-press">Promotion Expire Date</th>
                <th class="hide-on-button-press">Alert Picture ID</th>
                <th class="hide-on-button-press">Alert Expire Date</th>
                <th class="hide-on-button-press">Price List Description</th>
                <th class="hide-on-button-press">Part No. 1</th>
                <th class="hide-on-button-press">Part No. 2</th>
                <th class="hide-on-button-press" style="min-width: 200px;">Search String</th>
                <th class="hide-on-button-press">Category</th>
                <th class="hide-on-button-press">Manifacturer</th>
                <th class="hide-on-button-press">Sub Category ID</th>
                <th></th>
                <th></th>
                <th></th>
                <th>Properties</th>
                <th>Product New Status</th>
                <th>Product Xml Status</th>
                <th>Image Insert</th>
                <th></th>
                <th></th>
            </tr>
        </thead>
        <tbody id="productTableTbody">

            @for (int i = 0; i < Model.Products.Count; i++)
            {
                ProductDisplayData product = Model.Products[i];

                IndexProductTableRowPartialModel productRowModel = Model.GetTableRowModel(product, i, "productTable_item-" + i);

                <partial name="_IndexProductTableRowPartial" model='@productRowModel' />
            }
        </tbody>
    </table>

    <button id="addProductButton" class="btn btn-primary" style="width: 100%"
        onclick="addNewProduct('productTableTbody', 'productTable_item-@Model.Products.Count.ToString()', @Model.Products.Count, 'productTableHighestIdLabel')">
        +
    </button>

    <button id="triggerChangesCheckButton" class="btn btn-primary" style="width: 100px"
        onclick="triggerChangesCheck()">
        +
    </button>

        @Html.AntiForgeryToken()
</div>

<div id="ProductChanges_modal" class="modal fade" tabindex="-1" role="dialog">
    <div id="ProductChanges_modal_dialog" class="modal-dialog modal-dialog-full-parent-width">
        <div id="ProductChanges_popup_modal_content" class="modal-content full-parent-width full-parent-height modal-dialog-centered">
        </div>
    </div>
</div>

<div id="ProductFirstImage_modal" class="modal fade" tabindex="-1" role="dialog">
    <div id="ProductFirstImage_modal_dialog" class="modal-dialog modal-dialog-full-parent-width">
        <div id="ProductFirstImage_popup_modal_content" class="modal-content full-parent-width full-parent-height modal-dialog-centered">
        </div>
    </div>
</div>

<div id="ProductImages_modal" class="modal fade" tabindex="-1" role="dialog">
    <div id="ProductImages_modal_dialog" class="modal-dialog modal-dialog-full-parent-width">
        <div id="ProductImages_popup_modal_content" class="modal-content full-parent-width full-parent-height modal-dialog-centered">
        </div>
    </div>
</div>

<ul id="copiedXmlNotificationBox" class="copied-xml-notification-box"></ul>